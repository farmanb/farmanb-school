
% This LaTeX was auto-generated from an M-file by MATLAB.
% To make changes, update the M-file and republish this document.

\documentclass{article}
\usepackage{graphicx}
\usepackage{color}

\sloppy
\definecolor{lightgray}{gray}{0.5}
\setlength{\parindent}{0pt}

\begin{document}

    
    \begin{verbatim}
clear
P = @(v) v*v'/(v'*v);

A = [2 4; 0 -1; 2 -1; 1 3];
b = [-1 3 2 1]';
[m,n] = size(A);

x = A(:,1);

%Get the opposite sign of the first component of X.
sign = -1 * x(1) / norm(x(1));

w = zeros(size(x));
w(1) = sign*norm(x);

v = w - x;

H1 = eye(size(P(v))) - 2*P(v);

temp = H1*A;

x = temp(2:m,2);

w = zeros(size(x));
w(1) = norm(x);

v = w - x;
temp = eye(size(P(v))) - 2*P(v);
H2 = [1 0 0 0;
    0 temp(1,1:3);
    0 temp(2,1:3);
    0 temp(3,1:3);];

R = H2*H1*A
Q = H1*H2

d = Q'*b;

x = R\d

error = norm(b-A*x)
\end{verbatim}

        \color{lightgray} \begin{verbatim}
R =

   -3.0000   -3.0000
   -0.0000    4.2426
    0.0000   -0.0000
    0.0000    0.0000


Q =

   -0.6667    0.4714   -0.3250   -0.4772
         0   -0.2357   -0.8957    0.3771
   -0.6667   -0.7071    0.2208    0.0825
   -0.3333    0.4714    0.2084    0.7895


x =

    0.8333
   -0.5000


error =

    3.0822

\end{verbatim} \color{black}
    


\end{document}
    
