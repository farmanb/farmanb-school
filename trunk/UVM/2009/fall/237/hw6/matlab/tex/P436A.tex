
% This LaTeX was auto-generated from an M-file by MATLAB.
% To make changes, update the M-file and republish this document.

\documentclass{article}
\usepackage{graphicx}
\usepackage{color}

\sloppy
\definecolor{lightgray}{gray}{0.5}
\setlength{\parindent}{0pt}

\begin{document}

    
    \begin{verbatim}
clear
P = @(v) v*v'/(v'*v);

A = [1 4;-1 1;1 1;1 0];
b = [3 1 1 -3]';
[m,n] = size(A);

x = A(:,1);

%Get the opposite sign of the first component of X.
sign = -1 * x(1) / norm(x(1));

w = zeros(size(x));
w(1) = sign*norm(x);

v = w - x;

H1 = eye(size(P(v))) - 2*P(v);

temp = H1*A;

x = temp(2:m,2);

w = zeros(size(x));
w(1) = norm(x);

v = w - x;
temp = eye(size(P(v))) - 2*P(v);
H2 = [1 0 0 0;
    0 temp(1,1:3);
    0 temp(2,1:3);
    0 temp(3,1:3);];

R = H2*H1*A
Q = H1*H2

d = Q'*b;

x = R\d

error = norm(b-A*x)
\end{verbatim}

        \color{lightgray} \begin{verbatim}
R =

   -2.0000   -2.0000
    0.0000    3.7417
         0    0.0000
         0    0.0000


Q =

   -0.5000    0.8018   -0.0931    0.3138
    0.5000    0.5345   -0.2362   -0.6391
   -0.5000    0.0000    0.6086   -0.6161
   -0.5000   -0.2673   -0.7517   -0.3368


x =

   -1.0000
    1.0000


error =

    2.4495

\end{verbatim} \color{black}
    


\end{document}
    
